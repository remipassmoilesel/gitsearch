image: registry.gitlab.com/remipassmoilesel/gitsearch/ci-image:0.3

variables:
  GOCACHE: "$CI_PROJECT_DIR/.go-cache"
  YARN_CACHE_FOLDER: "$CI_PROJECT_DIR/.yarn-cache"

cache:
  key: global
  paths:
    - .go-cache
    - .yarn-cache
    - web-client/node_modules

stages:
  - build

build before merge:
  stage: build
  script:
    - ./scripts/ci.sh
  only:
    - merge_requests

build master:
  stage: build
  script:
    - ./scripts/ci.sh
  only:
    - master

